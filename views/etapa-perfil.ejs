<script>


    authFetchJson("/user/get", "GET").then((response) => {
        console.log(response.status);
        if ((response.status == 401 || response.status == 403)) {
            window.location.replace("/login");
        } else {
            console.log(response);
            response.json().then((data) => {
                console.log(data.user.username)

                if (data.user.verified == true) {
                    if (data.user.username) {
                        window.location.replace("/home");
                    }
                } else {
                    window.location.replace("/verificacao-email")
                }
            })
        }
    })


    const usrnm = document.getElementById("etapa-perfil-pesquisa-nome-input")
    usrnm.addEventListener("input", () => {
        // Remove caracteres não alfanuméricos e limita o valor a 500 caracteres
        usrnm.value = usrnm.value.replace(/[^a-zA-Z0-9 ]/g, "").slice(0, 30);
    });

    const bio = document.getElementById("etapa-perfil-biografia")
    bio.addEventListener("input", () => {
        // Remove caracteres não alfanuméricos e limita o valor a 500 caracteres
        bio.value = bio.value.replace(/[^a-zA-Z0-9 ]/g, "").slice(0, 100);
    });


</script>
<link rel="stylesheet" href="/styles/etapa-perfil.css">
<link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />

<div id="etapa-perfil">
    <nav>
        <a href="" id="etapa-perfil-voltar-login">Voltar para o login</a>
    </nav>
    <div id="etapa-perfil-conteudo-principal-alinhamento">

        <main id="etapa-perfil-conteudo-principal">
            <div id="etapa-perfil-conteudo-1" class="etapa-perfil-conteudo">
                <img src="/assets/logo-azul-incentiva.png" alt="" srcset="">
                <h2>Escolha o nome do seu perfil:</h2>
                <div id="etapa-perfil-customized-input">
                    <div id="etapa-perfil-hashtag">#</div>
                    <input type="text" id="etapa-perfil-pesquisa-nome-input" placeholder="Campo Obrigatório*"
                        onfocus="this.removeAttribute('error'); this.setAttribute('placeholder','Campo Obrigatório*' )"
                        autocomplete="off">
                </div>
            </div>

            <div id="etapa-perfil-conteudo-2" class="etapa-perfil-conteudo" style="display: none;">
                <img src="/assets/logo-azul-incentiva.png" alt="" srcset="">
                <h2>Escolha a biografia do seu perfil:</h2>
                <textarea id="etapa-perfil-biografia" style="resize: none;" placeholder="Sem biografia"></textarea>
            </div>

            <div id="etapa-perfil-conteudo-3" class="etapa-perfil-conteudo" style="display: none;">
                <img src="/assets/logo-azul-incentiva.png" alt="" srcset="">
                <h2>Escolha a sua foto de perfil:</h2>
                <div id="etapa-perfil-input-file-customizado">
                    <img src="" id="etapa-perfil-foto-previsu">
                    <label for="etapa-perfil-foto">
                        Foto de perfil
                        <span class="material-symbols-outlined">upload</span>
                        <input type="file" id="etapa-perfil-foto" style="display: none;">
                    </label>
                    <div id="etapa-perfil-foto-de-perfil-descricao">
                        Foto selecionada
                    </div>
                </div>

            </div>
            <div id="etapa-perfil-three-circles">
                <div></div>
                <div></div>
                <div></div>
            </div>
            <div id="etapa-perfil-buttons">
                <button id="etapa-perfil-voltar">Voltar</button>
                <button id="etapa-perfil-continuar-finalizar">Continuar</button>
            </div>

        </main>

    </div>
</div>
<script src="/scripts/etapa-perfil.js"></script>